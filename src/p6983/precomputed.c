
#include <assert.h>
#include "precomputed.h"
#include "uintbig.h"

// each basis entry is a triple of the form P,Q,P+Q

// this is initializing the point using the classical representation {0,...,p-1} for elements in GF(p).
// We don't use this representation for actual computation but rather the montgomery representation (the conversion is made in init_precomputations using the fp_enc function)
// hence the ***_uintbig[] defined below should not be used in any actual piece of code.
const uintbig torsion_basis_sum_uintbig[3][2][2] =
{{ { { 11035034994709316549ULL, 4713045545773165260ULL, 16818635257033828600ULL, 4744213660043784640ULL },
 { 14289906834413653469ULL, 10594115430474103962ULL, 17172246172988628419ULL, 6374926228486272610ULL } },
 { { 4423239338664220616ULL, 10769097379897872286ULL, 14585090878670002084ULL, 1356370573893650148ULL },
 { 10392427300923131031ULL, 6063115584862547ULL, 1052919352821255749ULL, 5076573478456446043ULL } } },
 { { { 17033858593965734738ULL, 6410140672237125452ULL, 7351037067167802008ULL, 3485202137154896229ULL },
 { 2873701578075643943ULL, 6404017074114771571ULL, 225131506886916053ULL, 4593253352620655592ULL } },
 { { 7691534975020003810ULL, 9124055673524570025ULL, 14719368571242896918ULL, 5371329044339278590ULL },
 { 10262505476890300335ULL, 4832077714516418142ULL, 14340512494377105369ULL, 2952436741616038789ULL } } },
 { { { 12856857826719560667ULL, 5418013040158386185ULL, 2350714974460668196ULL, 6261548062482313597ULL },
 { 8478711698388012491ULL, 1223991849638471423ULL, 12823368724097097713ULL, 6879399151566728293ULL } },
 { { 824900676674902916ULL, 37695957455984426ULL, 1414118002943424743ULL, 3988379084734183768ULL },
 { 11446634552914217147ULL, 9277508071652028719ULL, 7219421789566228673ULL, 3507273433727202376ULL } } } };
const uintbig torsion_basis_twist_sum_uintbig[3][2][2] =
{{ { { 4318285543381656778ULL, 3785455657551669008ULL, 14298219005364768576ULL, 9926847255727286869ULL },
 { 7810282938515805307ULL, 15804258017294858798ULL, 15863649635988516976ULL, 11147910445855043963ULL } },
 { { 16310687485717873053ULL, 4396728338477175037ULL, 9771832118289937671ULL, 10305031419789373394ULL },
 { 7185084312440758441ULL, 11745895497837028420ULL, 5109603019380223792ULL, 10346653543139301428ULL } } },
 { { { 13948327732418557757ULL, 14426823231115027239ULL, 16053830714817265454ULL, 381019013650588827ULL },
 { 6693866874963604885ULL, 9576019859915274575ULL, 372922756426519466ULL, 639163952488558152ULL } },
 { { 13980754433063936162ULL, 2969348244628488502ULL, 10585512542906698259ULL, 11502026657964513825ULL },
 { 5446634569644643009ULL, 18205581312957779153ULL, 3646495759106090746ULL, 529691177067000700ULL } } },
 { { { 18003118042927893750ULL, 12965122944699035501ULL, 140543317911541377ULL, 3923506609385009470ULL },
 { 12914681342552778730ULL, 7098627992951421606ULL, 12665173608299641948ULL, 8007190416082902462ULL } },
 { { 1852589616343326352ULL, 13698057988470153284ULL, 10715892595074998341ULL, 2918115977699054098ULL },
 { 17674458357511471365ULL, 9906456794891035411ULL, 3904069449887037028ULL, 4000783025638884906ULL } } } };
const uintbig torsion_basis_two_uintbig[3][2][2] =
{{ { { 6541478779643146121ULL, 5899928736526417687ULL, 12260611549213982059ULL, 8277460880516694128ULL },
 { 10410465435362225606ULL, 16081969572456613620ULL, 5430846961789297610ULL, 10381834745063123837ULL } },
 { { 4721756207581448014ULL, 14903541290199426862ULL, 1238377368719580997ULL, 6224359819988116455ULL },
 { 8956864341356192207ULL, 1256887143393257693ULL, 12476676520394732429ULL, 11193685939545883069ULL } } },
 { { { 8407452798345691641ULL, 5284954330376203917ULL, 17712202561373229101ULL, 11566389817705980867ULL },
 { 10470011256420516462ULL, 15053818218284720456ULL, 2535613467540333598ULL, 1065499221723899398ULL } },
 { { 15267068301155978600ULL, 624626144845519289ULL, 11314522305236201418ULL, 10960749245338806395ULL },
 { 14057580964100397708ULL, 16656366618251407407ULL, 7606097951903455213ULL, 1831533163022355072ULL } } },
 { { { 3735758332430717082ULL, 2081739251317199121ULL, 5679406864049943608ULL, 6618463907911274737ULL },
 { 1084686622166172913ULL, 8583798730852474057ULL, 11457474511411527954ULL, 9910141124993496613ULL } },
 { { 4471142628713677058ULL, 1908133940065384404ULL, 14572246122632885343ULL, 10959158086996206283ULL },
 { 12716229109786004173ULL, 18069003881367828767ULL, 6499821330465705122ULL, 2289148443448040351ULL } } } };


const uintbig torsion_basis_ted_sum_uintbig[3][4][2] =
{{ { { 6571199168674879792ULL, 3203075089855398583ULL, 6167795285466167790ULL, 1670492721485349557ULL },
 { 3436074219733589904ULL, 5387220793912503900ULL, 4153218440978768583ULL, 3546146657024607952ULL } },
 { { 12698624274448482985ULL, 3410636377371074763ULL, 7240914625731164269ULL, 247343130909560380ULL },
 { 10696135341780047074ULL, 202728396269802117ULL, 9691451996328932135ULL, 6050932482384306510ULL } },
 { { 845846625271597551ULL, 11419528536930441919ULL, 11451697512086758422ULL, 1133436796630085262ULL },
 { 16227348118615564393ULL, 1358130758050857594ULL, 10957314927994169431ULL, 7026353032826879673ULL } },
 { { 11397290534159643926ULL, 5644252087762115084ULL, 8738969590312782566ULL, 3736072467875101598ULL },
 { 7663501951282636378ULL, 6747161443738649643ULL, 12168051686153242973ULL, 9776804517650259227ULL } } },
 { { { 9567593670031751258ULL, 7046572358387743671ULL, 6219823803210500572ULL, 6243156695930632426ULL },
 { 16369393373696008828ULL, 14992578052144323459ULL, 17794491048634861024ULL, 2569105596058367130ULL } },
 { { 7697313996787099257ULL, 6470894481084355107ULL, 4766380873361380774ULL, 141030324623630675ULL },
 { 17294641108712615691ULL, 10721215437107852646ULL, 10604412121597418377ULL, 10304580004358062929ULL } },
 { { 17307759598800304738ULL, 17851531293100757462ULL, 7865295812725198480ULL, 1441211390277483878ULL },
 { 15977079259273809408ULL, 7738562221520647930ULL, 11719354233080370949ULL, 1953153193670572446ULL } },
 { { 13574482720298814759ULL, 15643597384699145712ULL, 8502596861830998988ULL, 1237174175493440544ULL },
 { 6371281205478679763ULL, 8667943013005587248ULL, 7004498727091504045ULL, 10982969780885380129ULL } } },
 { { { 13253885301609893160ULL, 15898406933840294383ULL, 10926413577243481746ULL, 6338410658403611428ULL },
 { 11322612886671278325ULL, 152395101430637174ULL, 10391547912213502344ULL, 240757024309517315ULL } },
 { { 9589117196443867423ULL, 3988995880274814559ULL, 17541162553001434761ULL, 10774992162588768552ULL },
 { 13973381436709109287ULL, 17539543711372973377ULL, 17647762091689339938ULL, 2904838307361549738ULL } },
 { { 17112389425212118342ULL, 7772063425631029858ULL, 3670833923868186738ULL, 6283945298578044710ULL },
 { 8530279863057498405ULL, 6279420874675618145ULL, 4249856559690545069ULL, 7945432710901318821ULL } },
 { { 5859608492237613103ULL, 7286195762096071909ULL, 17790871590852714905ULL, 302954761986412034ULL },
 { 17776899241943788009ULL, 15923684778214730176ULL, 12463596958839550672ULL, 74126198458505954ULL } } } };
const uintbig torsion_basis_twist_ted_sum_uintbig[3][4][2] =
{{ { { 3103653394782415520ULL, 17388918251594132703ULL, 8080843793930918241ULL, 11132438347094281815ULL },
 { 14392808953199656268ULL, 2739123601868662679ULL, 11259235769797847147ULL, 8162023597951801107ULL } },
 { { 8296888587072445646ULL, 16897624960310650139ULL, 11513659874678934449ULL, 3915812566708422443ULL },
 { 5517510974509526438ULL, 1167818249011736510ULL, 18404363620707932827ULL, 8908217661709296217ULL } },
 { { 4038630431734666951ULL, 11852873037852370902ULL, 1693795748022160424ULL, 10646844775186597957ULL },
 { 2694205462244366562ULL, 3090035188285368139ULL, 11388101738139217735ULL, 6117124629809881687ULL } },
 { { 5850813893689611936ULL, 15197313217010528005ULL, 4524381502363547953ULL, 2287368737484626038ULL },
 { 1613804315117231525ULL, 16171072784066933790ULL, 17868014197011054095ULL, 7439287822259416313ULL } } },
 { { { 13600671332057284204ULL, 3213338107039383510ULL, 6492052327142807213ULL, 10858246236573712877ULL },
 { 8390273028503613185ULL, 13531626129454080812ULL, 9319081917324355341ULL, 9358592066036206053ULL } },
 { { 13176236736611315127ULL, 3112829952086318190ULL, 5259499998305027723ULL, 7539424065344364469ULL },
 { 16282896673652341677ULL, 14424923530131747777ULL, 2263606770625641464ULL, 6457649628935635211ULL } },
 { { 14387061170605916993ULL, 10430289947995775710ULL, 16907196526715084349ULL, 637544514736492216ULL },
 { 11841378455894714189ULL, 18281505718566538785ULL, 5312390504836820937ULL, 4747187826362941918ULL } },
 { { 9492458766604036603ULL, 9140823989457934056ULL, 17304455721578510144ULL, 10649095603451787100ULL },
 { 14539797057033923889ULL, 4529502561144223119ULL, 7855380896814535867ULL, 10895843098520288305ULL } } },
 { { { 13963338117512546821ULL, 5087081097021133485ULL, 4526698773024460801ULL, 7832116403444527085ULL },
 { 16868866103212164712ULL, 11331773076928274898ULL, 7224773624387145866ULL, 330283781401029292ULL } },
 { { 17237347720273431625ULL, 14082438642074417538ULL, 11099705965887612153ULL, 9723629330172347419ULL },
 { 16575530896368126652ULL, 18297793429655436104ULL, 2992224852121889219ULL, 3408956438060431157ULL } },
 { { 5735265528202784425ULL, 297157380592319429ULL, 15488452227847113840ULL, 1334206493505887580ULL },
 { 14112430705106065129ULL, 7960761754768082974ULL, 12517593235717724487ULL, 6414027638324027630ULL } },
 { { 4401439048134532862ULL, 6979163036647078371ULL, 16724347383727809030ULL, 6179269207057816289ULL },
 { 9657258926785983749ULL, 9838304475035602519ULL, 7325965571711971354ULL, 8451587748087440230ULL } } } };


const uintbig torsion_basis_uintbig[12][3][2][2] = {
{{ { { 1055172688024496073ULL, 10013529793080891361ULL, 6504792545190799536ULL, 11733227005057815285ULL },
 { 17686001724908554654ULL, 14234554086552283655ULL, 15682235884594407012ULL, 6018112556655753678ULL } },
 { { 11522055058264012576ULL, 2354418337933533770ULL, 2069922382753607367ULL, 1691643890590802409ULL },
 { 7692231537726114791ULL, 7373898270846591501ULL, 8626644642567778607ULL, 8060761327490825259ULL } } },
 { { { 3689721474589596380ULL, 13374791522160468809ULL, 10937232676268731690ULL, 11000269873500644766ULL },
 { 9363440952389354153ULL, 14435622052270156262ULL, 1278777875237986428ULL, 4074290941222885034ULL } },
 { { 14165178813739365930ULL, 3905490699593213084ULL, 15886781004743509239ULL, 2596937985707889596ULL },
 { 15654483208821195318ULL, 15117560474302875100ULL, 14571564883767215038ULL, 4078224204370811973ULL } } },
 { { { 9435394602903486081ULL, 18360135204118595093ULL, 927764450520661690ULL, 7666000853450419205ULL },
 { 4377469925090003379ULL, 13005132713128741562ULL, 17577868704534191882ULL, 10415960293147000255ULL } },
 { { 0ULL, 0ULL, 6ULL, 18446744073709551613ULL },
 { 4421825632ULL, 8ULL, 140735963168880ULL, 18446744073709551612ULL } } } },
{{ { { 11724234580792195111ULL, 16829468752798790227ULL, 18028886475719068218ULL, 8498020493993487550ULL },
 { 14695910781124666149ULL, 11335272642099553201ULL, 7740058859925831276ULL, 8403517544480203347ULL } },
 { { 11885473931756590005ULL, 216530309847566996ULL, 5620194152397437063ULL, 597159610768719663ULL },
 { 13293914422267508397ULL, 2766220326024928375ULL, 16824509726739733295ULL, 8939012447684936968ULL } } },
 { { { 10566737384917655643ULL, 17314794750263551624ULL, 3804236115602027312ULL, 8131119102231246374ULL },
 { 2594035397861274620ULL, 11979156455374759353ULL, 13366806979776390734ULL, 1874508647338038753ULL } },
 { { 674230580133515035ULL, 16654054983539637333ULL, 1047632550079610237ULL, 10392989431726488086ULL },
 { 1412072170573795294ULL, 15738105710721389380ULL, 15402802783112185685ULL, 7631449792731853224ULL } } },
 { { { 17479476949585617211ULL, 16770406209428566565ULL, 14169093664112029820ULL, 1522394225548720765ULL },
 { 9156691276129786865ULL, 8652224368270436781ULL, 16342692683947229429ULL, 4330210752580426188ULL } },
 { { 4421835080ULL, 18446744073709551613ULL, 4421930888ULL, 8ULL },
 { 140735963168880ULL, 140732886311408ULL, 4ULL, 4329736365ULL } } } },
{{ { { 4274750454900687866ULL, 1042915931377345327ULL, 12410836647797603266ULL, 121200015915414022ULL },
 { 5465716605484491648ULL, 5854880261110670198ULL, 9855107904634919684ULL, 5873194343641539228ULL } },
 { { 7682164996132920118ULL, 3576439433856029307ULL, 11137447004426621013ULL, 6309189286171489492ULL },
 { 3392352713392442119ULL, 5783176036244616520ULL, 12499593270019595940ULL, 6119055567788504115ULL } } },
 { { { 9874150618890423315ULL, 1299776108005929354ULL, 13739545781243882104ULL, 1825910461633030434ULL },
 { 1985339014927946296ULL, 14300572620700435634ULL, 12100614525010392284ULL, 9821386748020283715ULL } },
 { { 11190257445452306720ULL, 7983735713384498359ULL, 15907600266536427121ULL, 6548771922287385781ULL },
 { 12054377946925987156ULL, 10108890876240038818ULL, 3144536501545736134ULL, 2521926381922628426ULL } } },
 { { { 6556685520436920346ULL, 11253658252089216561ULL, 13553425512285500097ULL, 5417777050582259155ULL },
 { 14630810692128691706ULL, 13669483317920812737ULL, 11398901023760739950ULL, 1565494098197917998ULL } },
 { { 140732886309792ULL, 1ULL, 4428287800ULL, 4428265784ULL },
 { 140732886309232ULL, 4427908516ULL, 140735052879264ULL, 4428256128ULL } } } },
{{ { { 17937916421431437827ULL, 10143952340740766924ULL, 8770985630760448528ULL, 7175635299642962098ULL },
 { 2103903644771168372ULL, 18253983930496815114ULL, 15741333068856800677ULL, 1287522428991886144ULL } },
 { { 9107444662098971946ULL, 6212255887036184591ULL, 8695363185950164539ULL, 2270574815730123592ULL },
 { 3201337823184487288ULL, 11651177154647821846ULL, 6689764696749976437ULL, 10236046182515007291ULL } } },
 { { { 4967723502184324473ULL, 4404676244345145024ULL, 11214304879288574198ULL, 545045917383991638ULL },
 { 15595218967914305623ULL, 5598612573424118633ULL, 15837040590371682474ULL, 6053800744455397626ULL } },
 { { 17931811883718858268ULL, 3699255092725754060ULL, 6206550285712210774ULL, 509096646997486906ULL },
 { 3412378518843259012ULL, 5592736600236877679ULL, 7452160449728510430ULL, 1748989685283986838ULL } } },
 { { { 2445792386547043300ULL, 4918643394546518953ULL, 12812018998532827761ULL, 1070608715017391696ULL },
 { 10665098499571618241ULL, 18105258956369634543ULL, 3413613288305080119ULL, 3780611226218253278ULL } },
 { { 8ULL, 140732886309920ULL, 140732886309936ULL, 4329722308ULL },
 { 140732886309616ULL, 4427832182ULL, 11143722001909612621ULL, 0ULL } } } },
{{ { { 3676977528009506309ULL, 16739187063072077753ULL, 3886868416469537140ULL, 9978465573654534791ULL },
 { 18112902938952583832ULL, 6940141136653519789ULL, 3319124431418167359ULL, 9253673517073085411ULL } },
 { { 1621571607456951283ULL, 5618583296595989426ULL, 17549598237915903431ULL, 10127921751848657739ULL },
 { 13939795079520259240ULL, 15667889707759106567ULL, 1289838914383087389ULL, 289662245790804463ULL } } },
 { { { 6444426700115524364ULL, 17709717100173707115ULL, 11058043175258015625ULL, 2297675298621372001ULL },
 { 10494183475719085029ULL, 17252151340286541972ULL, 11619217423296976141ULL, 2834022627154364480ULL } },
 { { 18358960803396620334ULL, 1530346391297776566ULL, 15028271138801253110ULL, 7445400416966105905ULL },
 { 17277191112274555509ULL, 9220929622236921632ULL, 6409260955402789822ULL, 10167104352406169176ULL } } },
 { { { 1519643926892785359ULL, 2611128665721909103ULL, 17469497521580595952ULL, 10210113713744261916ULL },
 { 935504172705414249ULL, 9211077951952450826ULL, 17222944286925759232ULL, 646132757755987928ULL } },
 { { 140732886311088ULL, 140735050785582ULL, 895ULL, 0ULL },
 { 0ULL, 281470681751456ULL, 0ULL, 65535ULL } } } },
{{ { { 5146768774281713188ULL, 15222860980833287981ULL, 16026962945287816180ULL, 4679362681141413355ULL },
 { 17256149205122878918ULL, 9641410491301565839ULL, 10307329765802480065ULL, 1968762503160261121ULL } },
 { { 14923220943981539342ULL, 2672261187383343534ULL, 14335665073102294825ULL, 5614230698386371410ULL },
 { 10804462634345194893ULL, 3771443826115610397ULL, 16467624740377962401ULL, 8570412551286984861ULL } } },
 { { { 9357857296145098948ULL, 3195762045218233547ULL, 14065318607742119697ULL, 12070275901218534ULL },
 { 11037688081083176685ULL, 18199786141045734529ULL, 17140098570911799827ULL, 3743518950688494349ULL } },
 { { 13893099386103521859ULL, 12525530346355377758ULL, 10587339722449628263ULL, 10303219252289995458ULL },
 { 17848097901444405868ULL, 15958085644204298419ULL, 10187123778849560299ULL, 8244599944545307259ULL } } },
 { { { 9691881785702467403ULL, 9662393880149777800ULL, 3438592631845084124ULL, 5882955548014832875ULL },
 { 11740878775609763766ULL, 14681851813866237000ULL, 2549847857880584529ULL, 11279205719379794666ULL } },
 { { 140732886310944ULL, 1ULL, 4428271312ULL, 4428265784ULL },
 { 140732886310384ULL, 4427908516ULL, 4329639248ULL, 4428256128ULL } } } },
{{ { { 5905832543528845107ULL, 7060181199275574011ULL, 7105472243648534071ULL, 4292486259803622500ULL },
 { 10289073890490126946ULL, 8200241547569660301ULL, 1042820545301721676ULL, 1012432107552871363ULL } },
 { { 12665344044850340841ULL, 10542710371253680024ULL, 4801338942008129321ULL, 4052015941291455386ULL },
 { 744363327761649478ULL, 7777127930920589963ULL, 10002611072815861933ULL, 1536839207673932566ULL } } },
 { { { 4868716953231068767ULL, 11451473953545402224ULL, 1289730317856083349ULL, 7812666447938285754ULL },
 { 14448430042058873457ULL, 6577035018168540690ULL, 17818390091098259253ULL, 4363631923167892872ULL } },
 { { 15870505984232568815ULL, 16806904664393524104ULL, 12433036426095422516ULL, 5032400953598486833ULL },
 { 12579580525310753644ULL, 11556306213526298759ULL, 6661561310478682209ULL, 10626297803689569478ULL } } },
 { { { 4219555086562542161ULL, 9970070216074479233ULL, 18136022478249392456ULL, 5992009238390689739ULL },
 { 15033329538740146987ULL, 14637899005107268699ULL, 15878169043383062163ULL, 5121232336424571397ULL } },
 { { 140732886310768ULL, 4427908255ULL, 140732886310800ULL, 4427933758ULL },
 { 4428265784ULL, 4428271312ULL, 11143722001909612621ULL, 0ULL } } } },
{{ { { 17532518342784414772ULL, 16180115273429343208ULL, 4691472011319908069ULL, 2491269709908942856ULL },
 { 3804288226395708976ULL, 17376825013658137996ULL, 8058009040215631535ULL, 715123991857616035ULL } },
 { { 12606995220326167755ULL, 16380454523731139072ULL, 4206760350749161394ULL, 3007768362185609249ULL },
 { 1535749710316438233ULL, 5281914380188377785ULL, 15435210060874313346ULL, 5510955295299809568ULL } } },
 { { { 8450588359400310032ULL, 13347348953157605223ULL, 7824809269241161740ULL, 7846292921909372535ULL },
 { 8872557919841243494ULL, 7153724912556101444ULL, 17858539985834562253ULL, 1911941265267187414ULL } },
 { { 11910433978052861414ULL, 5760678502522978491ULL, 7907540547793353927ULL, 2738316243350196718ULL },
 { 65517931057892440ULL, 1757770437636902061ULL, 13126298717661968476ULL, 2059663124936033090ULL } } },
 { { { 4696046384334371697ULL, 5008648296124618340ULL, 13223353747191440882ULL, 895934552689224314ULL },
 { 3949587480500312708ULL, 8606991659341423855ULL, 12787102700399423988ULL, 6574070216699216509ULL } },
 { { 140732886312240ULL, 140735050785582ULL, 895ULL, 0ULL },
 { 0ULL, 281470681751456ULL, 0ULL, 65535ULL } } } },
{{ { { 18366905166652007181ULL, 6204925135717696211ULL, 6458644480881351729ULL, 1431389244744250449ULL },
 { 8942776535783434133ULL, 4999194017326111769ULL, 3054161707346307188ULL, 10712068095758719724ULL } },
 { { 15470465517458785361ULL, 16213033423950673664ULL, 10584285905777370037ULL, 6784193728745434986ULL },
 { 5800000338404840094ULL, 3048882129721044728ULL, 2613108169027320880ULL, 11332125527531086419ULL } } },
 { { { 3031361218712050610ULL, 7853768537795028716ULL, 2935938440893046337ULL, 7926221730663367865ULL },
 { 16202784528440031258ULL, 6508199654044950914ULL, 6078619005060172120ULL, 451682137038712621ULL } },
 { { 13116535752214991650ULL, 5376979405406463571ULL, 14707178648744798088ULL, 9069182714073558152ULL },
 { 344488853262933577ULL, 13774631694212900378ULL, 11670111401022201138ULL, 10313791544981742931ULL } } },
 { { { 6320849413925326429ULL, 11868610762227878019ULL, 17709651597089816760ULL, 10377536737459339889ULL },
 { 13161102432520416217ULL, 18131132878365002832ULL, 9216083345452701441ULL, 5484289428374147741ULL } },
 { { 3916060698916636595ULL, 11546029375759944074ULL, 140732886312384ULL, 4329900853ULL },
 { 140732886311808ULL, 4ULL, 0ULL, 0ULL } } } },
{{ { { 7669346912911761918ULL, 13173621137652832241ULL, 7656216766074523621ULL, 10930039287271727040ULL },
 { 11631878702331424279ULL, 10632034783404257795ULL, 2284552441164146242ULL, 2791823707804892597ULL } },
 { { 3573001847087194090ULL, 18239364710535260452ULL, 9618667110694735128ULL, 8613749124883562394ULL },
 { 6289028467816341288ULL, 2361499713543693747ULL, 14716887312601433895ULL, 145087074389179109ULL } } },
 { { { 11412645424849077206ULL, 13407022911148263005ULL, 6410453995492757769ULL, 8638908344782006306ULL },
 { 8700838471602641722ULL, 9628487440507594521ULL, 4249617617464132555ULL, 10529936893349723371ULL } },
 { { 15897328762309487655ULL, 17585898485134703481ULL, 5879915459617792728ULL, 7357997051192668978ULL },
 { 14241948163646787958ULL, 8921548807609063490ULL, 2745925347663161985ULL, 4429207348704845968ULL } } },
 { { { 9460997465084224320ULL, 12922287063476466928ULL, 15728102373816806497ULL, 9582121028057387764ULL },
 { 13522305914935495066ULL, 3740057210442916333ULL, 15434518690621797897ULL, 11500343687500528746ULL } },
 { { 5821538663162445817ULL, 15109582218568749769ULL, 12852277884285521723ULL, 11747944629569890704ULL },
 { 1ULL, 0ULL, 0ULL, 0ULL } } } },
{{ { { 10043898241317943539ULL, 4143190055107039595ULL, 3951685361935202559ULL, 7310712031595454733ULL },
 { 13382834484241620916ULL, 11085241524465235793ULL, 12751855366232705260ULL, 5193537363286991380ULL } },
 { { 5737345223468324280ULL, 9675941547821255038ULL, 7585118705755242577ULL, 6759422084161124637ULL },
 { 102084569449909546ULL, 12864805578970992223ULL, 2799753613275976401ULL, 5438039053611349385ULL } } },
 { { { 7807945086631928511ULL, 7209294685458850042ULL, 14819005469007974986ULL, 5308568393992961970ULL },
 { 17538123812630580272ULL, 4896206406830115209ULL, 15604536995256103013ULL, 9104922037652947065ULL } },
 { { 2976622517836014207ULL, 7598252557076890687ULL, 15480719422276151656ULL, 3898520126893196124ULL },
 { 16823978709839925873ULL, 7087722955558012710ULL, 3421448131188262787ULL, 10282036204127771521ULL } } },
 { { { 977991493908476665ULL, 16843955794146895106ULL, 15095781851808824190ULL, 3428183115178069518ULL },
 { 17048681856562754311ULL, 17026775537074019377ULL, 11311176839787895218ULL, 1843878795592719906ULL } },
 { { 0ULL, 0ULL, 17464615989487337463ULL, 8435258508287146075ULL },
 { 1663345505437461939ULL, 16797089815000120498ULL, 1ULL, 0ULL } } } },
{{ { { 2639399242119612107ULL, 11116232717752037211ULL, 9183788052516702055ULL, 8782480389704324674ULL },
 { 5892548915709182198ULL, 7136517466692688657ULL, 6295618433043431280ULL, 5191108988937716059ULL } },
 { { 4317383988463527408ULL, 14237655587133397676ULL, 17517409229075805734ULL, 4289936862315857736ULL },
 { 7246952209796746406ULL, 4361846180093948558ULL, 1919825821794056450ULL, 163002012402918256ULL } } },
 { { { 6729426155646011455ULL, 5102060652941634278ULL, 13808447048189372242ULL, 3553923681976468599ULL },
 { 12559615844231345497ULL, 18242952996027556453ULL, 9040483994196228959ULL, 10522214160067705901ULL } },
 { { 4459875061648950951ULL, 16480105532309045294ULL, 12472551814915893037ULL, 2699982400222353126ULL },
 { 5771901286552680250ULL, 408777649421964292ULL, 6736706218142780740ULL, 5362529852725323184ULL } } },
 { { { 5131437635002999691ULL, 16037889212581792066ULL, 10454748559037401242ULL, 9169487492709524989ULL },
 { 8702654931688361574ULL, 7907560197301059451ULL, 9466825163583769021ULL, 4609678786248925129ULL } },
 { { 6014680576ULL, 4329526504ULL, 4341042472ULL, 4421942280ULL },
 { 140732886312976ULL, 4421935256ULL, 140732886313520ULL, 4329426671ULL } } } } };
const uintbig torsion_basis_twist_uintbig[19][3][2][2] = {
{{ { { 416661706308348835ULL, 11610627336875565995ULL, 6712761095211728083ULL, 5017876601469998222ULL },
 { 5933588469080199655ULL, 6669582433996093840ULL, 345613021433562822ULL, 8657056966252617913ULL } },
 { { 16214822690090935986ULL, 6310689383356286837ULL, 7951326348050632860ULL, 9144228760865593626ULL },
 { 18087425981590865282ULL, 15490017614673705972ULL, 18174837334470170703ULL, 6875747947284450202ULL } } },
 { { { 14654956032210993100ULL, 10201460361452359654ULL, 8139123291431654301ULL, 788404581928945495ULL },
 { 4610056249930791688ULL, 481846461871376724ULL, 4198536820736503078ULL, 6811304536683219522ULL } },
 { { 6545135572194745624ULL, 5727294078663597057ULL, 14487743523941929271ULL, 6487465430033450959ULL },
 { 1344460040261319609ULL, 3073984991814425845ULL, 15234885349431226369ULL, 3439836977832526092ULL } } },
 { { { 2676188582107456261ULL, 15630069185910735514ULL, 2727451029473829477ULL, 6711871515103313611ULL },
 { 1231689832360247840ULL, 10477417787556365703ULL, 5508488932538149423ULL, 4262294533130854844ULL } },
 { { 3320242733518064576ULL, 15636497906230362112ULL, 27375227668ULL, 15456353921135542272ULL },
 { 12511394305ULL, 264851428752116104ULL, 12852277884285521723ULL, 4329874756ULL } } } },
{{ { { 5188608872134981019ULL, 14447372798144512134ULL, 6238349512305958313ULL, 606437944790932770ULL },
 { 17456405045036541820ULL, 899615298772597341ULL, 17461900306742981389ULL, 5772437793655745054ULL } },
 { { 18419181443673957917ULL, 2748216505867077998ULL, 8172980124419388148ULL, 1208031332288122897ULL },
 { 736615045482726647ULL, 2615894360528155324ULL, 16681957030462983695ULL, 10446674282740988732ULL } } },
 { { { 6508303709605740833ULL, 18078811117438170782ULL, 7796863205592419493ULL, 717408421403834573ULL },
 { 4312896410656789684ULL, 1975097700298977501ULL, 10921792168323826802ULL, 9972371461654799164ULL } },
 { { 17055880748064803018ULL, 3090850542337621230ULL, 12457224817023842056ULL, 8070556101942661663ULL },
 { 3081406274629718642ULL, 8240089393428660669ULL, 12660440489915251227ULL, 3228253740112309852ULL } } },
 { { { 8348379884380023263ULL, 10016960808997443563ULL, 5265194993337579878ULL, 1178658915498480629ULL },
 { 12394892656670015512ULL, 13645857126356812911ULL, 6829640038206467306ULL, 8517479808862498777ULL } },
 { { 0ULL, 11592768959842109ULL, 0ULL, 140732886292856ULL },
 { 140732886292576ULL, 11747944629569890704ULL, 5483458601319817170ULL, 11747944629569890704ULL } } } },
{{ { { 218631481031624977ULL, 12700470688490049737ULL, 9470946314335656069ULL, 668744081427102416ULL },
 { 15697554721628748504ULL, 11579616384376392921ULL, 6770797860624681920ULL, 9476357094705040591ULL } },
 { { 4794937508649816969ULL, 10728504217735621425ULL, 3995638214302668151ULL, 6309038282623486904ULL },
 { 11869184235992167172ULL, 18217774831047675127ULL, 14831461109508642270ULL, 7374793933829118777ULL } } },
 { { { 7872350372791773917ULL, 8673018435997943799ULL, 704750695687753298ULL, 10871064560906956793ULL },
 { 14575567546131413939ULL, 8928333213273817650ULL, 10377388080498270948ULL, 9614677651325203992ULL } },
 { { 7007791695789685693ULL, 14022700116876016454ULL, 7354106101409075402ULL, 754810903215717282ULL },
 { 6274139828123834288ULL, 4983838987012524515ULL, 12384994125107558430ULL, 8456831254980167627ULL } } },
 { { { 1406925194228370016ULL, 9088678737938064426ULL, 8643923137020169584ULL, 8668228326811278284ULL },
 { 16420200310127077344ULL, 157235909209436206ULL, 11571178036320721852ULL, 2866656953670346579ULL } },
 { { 247ULL, 127ULL, 138ULL, 2673133955078574282ULL },
 { 2133074979363639247ULL, 1932360943379645639ULL, 1541961925099814737ULL, 140732886293120ULL } } } },
{{ { { 7627414676473301041ULL, 16092963726706464257ULL, 5051205445192835374ULL, 6500256286707488828ULL },
 { 8517081601831810872ULL, 7504684386803377632ULL, 7350671540159754899ULL, 6923045798828115512ULL } },
 { { 18328941203193256485ULL, 4002476172702769389ULL, 15642782689524625735ULL, 6891147949765836693ULL },
 { 10112953266436524095ULL, 1474905416759433513ULL, 8411397771330382453ULL, 11711222473305936082ULL } } },
 { { { 2979398797870711844ULL, 1625710428246832086ULL, 15966458955406924165ULL, 7445182602277644865ULL },
 { 974304107721884032ULL, 2088200403681095261ULL, 8243905978612903883ULL, 1386410343735177441ULL } },
 { { 13119523041432438362ULL, 13211523176615021798ULL, 9359596387661828143ULL, 4135901577148539428ULL },
 { 4528332085265725984ULL, 7943368744706650345ULL, 3494443360492558448ULL, 3569554952080995704ULL } } },
 { { { 5152593742545216070ULL, 15553718917763897599ULL, 9578802598742577610ULL, 6407106677990507203ULL },
 { 16349516936747200860ULL, 2884741201574255836ULL, 4909146933271576452ULL, 3014036342554467074ULL } },
 { { 3ULL, 0ULL, 140732886293120ULL, 10518524120050797640ULL },
 { 140732886293016ULL, 140732886293152ULL, 5ULL, 4329521544ULL } } } },
{{ { { 16134555026634111305ULL, 4850228250068186321ULL, 17198610298630277953ULL, 3909072951898919778ULL },
 { 15824849199020453436ULL, 18041773519066480511ULL, 4841924491932514040ULL, 9597214337891923176ULL } },
 { { 10446247150910408307ULL, 8142616230321495402ULL, 12521769621434653153ULL, 8102147819792434211ULL },
 { 7561240147278168365ULL, 10162074631608023157ULL, 16189918926341552522ULL, 5931660932951270941ULL } } },
 { { { 5364011951492666897ULL, 16380732734230868600ULL, 4446376154799947251ULL, 10523835955329958282ULL },
 { 9803065759747304823ULL, 17873869870566129216ULL, 15479251226731765232ULL, 7479963526487405258ULL } },
 { { 11810008521151142360ULL, 6979667138014367866ULL, 10021604539132769194ULL, 3691596341166659941ULL },
 { 18376123060939630819ULL, 8632956167400878323ULL, 12839720466268297951ULL, 8509640927374079333ULL } } },
 { { { 2084600297811425873ULL, 3363874046179810825ULL, 15232208454358403474ULL, 2551270907816705332ULL },
 { 10229607091313269674ULL, 4960186197910170320ULL, 7325823054420036806ULL, 5198722462287819924ULL } },
 { { 0ULL, 3723919686356729873ULL, 9310240781765257147ULL, 13362894150913757475ULL },
 { 12852277884285521723ULL, 11747944629569890704ULL, 4598946871110336088ULL, 8510257417159956434ULL } } } },
{{ { { 13991767164976982525ULL, 11838903644466900808ULL, 16431323570245022666ULL, 11148385922802464488ULL },
 { 9744971981864613007ULL, 11045489982128358742ULL, 5627551562117283330ULL, 298261542264651166ULL } },
 { { 8212236680210504898ULL, 16772825991994152290ULL, 10052704750717892991ULL, 1515615050168386942ULL },
 { 4152105217223813083ULL, 9605318233781732464ULL, 4651477703995412191ULL, 9328344523041303222ULL } } },
 { { { 5370035464070254939ULL, 18186498617822160183ULL, 115094212918591202ULL, 7555838713857210974ULL },
 { 17035346688781528918ULL, 3705140511800952212ULL, 14579263560754129565ULL, 10073242206942035331ULL } },
 { { 8681882279224991691ULL, 2298383878234760573ULL, 3245578967029509941ULL, 2047103558814594915ULL },
 { 15213425476195129663ULL, 8231901317644162089ULL, 7433409309895056646ULL, 2215894187634228019ULL } } },
 { { { 9981439976658482881ULL, 778704028625006270ULL, 15399815067409799450ULL, 4310078249587508027ULL },
 { 13277512768149487486ULL, 7759870724423114775ULL, 10000963106983535791ULL, 200191526526222758ULL } },
 { { 0ULL, 4329769632ULL, 11143722001909612621ULL, 140732886296064ULL },
 { 0ULL, 140732886296376ULL, 140732886296056ULL, 140735963168880ULL } } } },
{{ { { 11574854601694880623ULL, 13479359445998592056ULL, 7276632639512681624ULL, 134203379456203399ULL },
 { 9084139945164683099ULL, 7472125884879426560ULL, 1664419906791455049ULL, 3899070237988929635ULL } },
 { { 7014933889234781953ULL, 2173583517590876279ULL, 10331186847441965117ULL, 11523326103867093973ULL },
 { 4045903077733492806ULL, 2788621079361708818ULL, 3957333454581130226ULL, 1703501815152613024ULL } } },
 { { { 6572273305523926533ULL, 6419862482616658141ULL, 14645449261492755920ULL, 9411356659336989921ULL },
 { 10308895069811296942ULL, 11890857831867040213ULL, 3303559572624594774ULL, 4194708022998520262ULL } },
 { { 15549352171181944116ULL, 17195268722072436436ULL, 12687802073973321699ULL, 10119657979831321398ULL },
 { 5611317803631655707ULL, 6310205305519498212ULL, 2148114503385903694ULL, 578177135496257404ULL } } },
 { { { 17959924087808919907ULL, 18074920419209649301ULL, 1828520496931516392ULL, 5094692676143268501ULL },
 { 4551309144728020194ULL, 3577880287810841148ULL, 5436528538112673863ULL, 3999935587310202677ULL } },
 { { 140732886296128ULL, 140732886296048ULL, 4ULL, 4329735896ULL },
 { 4ULL, 4329735896ULL, 4ULL, 9685640607508144854ULL } } } },
{{ { { 13246281363289128800ULL, 12476891508423902399ULL, 4477364414748506802ULL, 11712522565727112329ULL },
 { 1224233091510736543ULL, 10957186033289595875ULL, 9901665652191643717ULL, 5552671470474171418ULL } },
 { { 17345551510882944244ULL, 11367983796451482533ULL, 12365826116683279863ULL, 11077829785254885451ULL },
 { 4767936378035570881ULL, 9662868992849839771ULL, 2567140778681085012ULL, 7064062510411471722ULL } } },
 { { { 8329606536362864259ULL, 10704532781230270634ULL, 3905193898523564446ULL, 3519704768034435506ULL },
 { 11874808190349007912ULL, 8710743228405875041ULL, 3334789406812835857ULL, 1635679824972486605ULL } },
 { { 507278362299997829ULL, 6586099039872986220ULL, 16064191022811841407ULL, 2357472109175900955ULL },
 { 16069834210405209347ULL, 4605119346229315276ULL, 3847420095339486748ULL, 4335057969247706365ULL } } },
 { { { 5870594284938777390ULL, 18140696894758642419ULL, 10363148376291639536ULL, 5921989635161330144ULL },
 { 13862518330810933634ULL, 13447158012956930538ULL, 6803875994444204245ULL, 5199093154304441818ULL } },
 { { 11747944629569890704ULL, 10518524120050797640ULL, 140732886294536ULL, 140732886294888ULL },
 { 2ULL, 4329521544ULL, 0ULL, 140732886297536ULL } } } },
{{ { { 9486045430801906879ULL, 13886204272369761443ULL, 5408244632086600560ULL, 614672257473581554ULL },
 { 9679018403005880771ULL, 15841542321525108082ULL, 959713655544440958ULL, 11700405891903325043ULL } },
 { { 16096244358412346812ULL, 16536448276132955614ULL, 1004691067458485000ULL, 2469264804171537045ULL },
 { 17851462565798677801ULL, 294385572903541950ULL, 847129145805186038ULL, 10566815351316111521ULL } } },
 { { { 9600111930218489680ULL, 13428522298915636915ULL, 2489069554410281295ULL, 1976715732048281599ULL },
 { 4444150881924724340ULL, 5974031866037104117ULL, 1456919521133757338ULL, 3758953927583333047ULL } },
 { { 15276386227685328460ULL, 10554660304960912402ULL, 12824253314341024810ULL, 7005668665246449423ULL },
 { 6825417672728456876ULL, 13412350576971225240ULL, 7834917844442421194ULL, 8480377292630110117ULL } } },
 { { { 17147107423235674945ULL, 17164800293019185524ULL, 3958703975149578795ULL, 6142446501113104575ULL },
 { 13176471517759946822ULL, 17360738872049202097ULL, 12930774298162794553ULL, 8070713683773433721ULL } },
 { { 10518524120050797640ULL, 11747944629569890704ULL, 140732886294736ULL, 4329521544ULL },
 { 4ULL, 0ULL, 140732886295056ULL, 4329775975ULL } } } },
{{ { { 14521892817836873632ULL, 8945783384545875396ULL, 7750010036210429451ULL, 4527831706482716441ULL },
 { 5010574427995818277ULL, 14358725387528192011ULL, 16791285647987675132ULL, 7818128462938169709ULL } },
 { { 18309669679530974451ULL, 6925753898951989705ULL, 12529091755891176328ULL, 4056716822789291435ULL },
 { 1546139698148156659ULL, 10831577426054562409ULL, 13433598194442835484ULL, 4711239996424406815ULL } } },
 { { { 10222203261860855938ULL, 1278435827850726962ULL, 6900769875486527733ULL, 8448918414828015292ULL },
 { 3431350058238811442ULL, 14148606236785752608ULL, 2725640843391102934ULL, 9951197201906313007ULL } },
 { { 10101701686875000713ULL, 17397852357904057967ULL, 1676901171605857148ULL, 2936904096983874852ULL },
 { 14927116588197799672ULL, 12289795789104342281ULL, 2383533337894325222ULL, 1297110408101659194ULL } } },
 { { { 5208984376371055463ULL, 14464910491230302228ULL, 1870190236628449852ULL, 6824991551587300973ULL },
 { 8528927229123495447ULL, 14299456575396525235ULL, 15924504925023889941ULL, 10566724176348881615ULL } },
 { { 7660439004627788888ULL, 8717008052404100129ULL, 9612345757659103308ULL, 1497883368460072844ULL },
 { 560879299227603847ULL, 4387940597710772068ULL, 7668025622864280268ULL, 1893226917971902813ULL } } } },
{{ { { 9553202060702207924ULL, 12813688275407097677ULL, 13430972645044787467ULL, 7441044129713880871ULL },
 { 8542766578854823937ULL, 2982432392530783078ULL, 10402702941484712092ULL, 8200245480290789914ULL } },
 { { 2952485952819261701ULL, 6565668559280192120ULL, 17046113490832861493ULL, 1329478685920293537ULL },
 { 649318010157824173ULL, 10022409878864245424ULL, 8948822979497559160ULL, 10700860540241930261ULL } } },
 { { { 6242551420638462709ULL, 10457417345726126244ULL, 16180158379176098903ULL, 1851112371101440371ULL },
 { 14048703932757485663ULL, 16809722906672258696ULL, 8320964415590742618ULL, 5129164797042375922ULL } },
 { { 893344829612472085ULL, 1458992666395520528ULL, 1611674357021545293ULL, 6558693092174839300ULL },
 { 14252743027187572880ULL, 3325524189843259628ULL, 9536956465633694789ULL, 1227221030595777375ULL } } },
 { { { 5214767205157679434ULL, 4931700920013674290ULL, 9343891725399119192ULL, 4179840875544605399ULL },
 { 11674195906163827325ULL, 14925388320579054923ULL, 15734947810949260207ULL, 3482666945536392932ULL } },
 { { 16180335322319091086ULL, 15711013943434921719ULL, 12852277884285521723ULL, 4329874756ULL },
 { 4ULL, 140732886295728ULL, 3ULL, 0ULL } } } },
{{ { { 5984834440095144096ULL, 16980900305618465100ULL, 14326501803047756437ULL, 11368837317419120524ULL },
 { 18413378070921619560ULL, 9271886571330955384ULL, 3339194523075214919ULL, 9736588589696590547ULL } },
 { { 9845997275989400558ULL, 2970534535698235100ULL, 5415939407151137747ULL, 7128405888858712893ULL },
 { 9269008791987602065ULL, 3500140821704257654ULL, 6360005657258244218ULL, 7632860771395616821ULL } } },
 { { { 5997577287460103622ULL, 10749539635174595174ULL, 17657227932059679574ULL, 3880765319210935011ULL },
 { 6824731315141676679ULL, 1480767648323220215ULL, 15380674269833800713ULL, 8906069642508976748ULL } },
 { { 5659426844692897522ULL, 9909960664247796710ULL, 8766411477382837428ULL, 598574657272580727ULL },
 { 12995682110851469840ULL, 12876470611722828817ULL, 2735282319353879804ULL, 3210378737012179742ULL } } },
 { { { 1034011280960300055ULL, 5257480468533833911ULL, 18151414597467017968ULL, 7121104870180044390ULL },
 { 761922779353951968ULL, 2871640311927634985ULL, 3245945699399207187ULL, 5869864861415964966ULL } },
 { { 8769860714098134407ULL, 11747944629569890704ULL, 1290970167038876599ULL, 11328185676776174876ULL },
 { 3734128794351992716ULL, 8ULL, 8ULL, 140732886296128ULL } } } },
{{ { { 12157397816297298886ULL, 10238038268655690930ULL, 6627616053492033643ULL, 4138096834357979628ULL },
 { 15933619474202481637ULL, 9321687995589666961ULL, 9595813528141604203ULL, 10311335580539760557ULL } },
 { { 636905607652571268ULL, 1778026451059415276ULL, 9159640537344085418ULL, 4486608805812359169ULL },
 { 6431611491555645374ULL, 8851103569226320702ULL, 17245725452287882944ULL, 11345415960786408324ULL } } },
 { { { 16887059154337396823ULL, 11554496573754320569ULL, 2955929782457530677ULL, 1958436916124415643ULL },
 { 7666378601721436279ULL, 10466362955744886358ULL, 17739517142361137355ULL, 7122003604283535113ULL } },
 { { 16288671331926562114ULL, 12823498778729257052ULL, 17228271964217229380ULL, 3227998259488927203ULL },
 { 3745965170046475199ULL, 5177831057292231668ULL, 8613033110232503024ULL, 9799032758994197728ULL } } },
 { { { 15206670329811390136ULL, 16442838508673626509ULL, 13478941685747702841ULL, 3288660673453284230ULL },
 { 13257173173481535512ULL, 1719651677679624975ULL, 13994989425508045984ULL, 9477017370540277495ULL } },
 { { 3520995872960384812ULL, 3734052523809698995ULL, 11898573768263327704ULL, 17083580093434965623ULL },
 { 12850453941193437827ULL, 164084462569977159ULL, 0ULL, 5006375339903043528ULL } } } },
{{ { { 8377896756441966469ULL, 6661906879330735650ULL, 8101891810091325681ULL, 4921465101971348231ULL },
 { 13761193589843442655ULL, 5189667357666631738ULL, 7278491144326591252ULL, 1761619009126037636ULL } },
 { { 11637535998722966486ULL, 16421358831353440039ULL, 16800201850258869498ULL, 10071233386156914935ULL },
 { 15564050875382800172ULL, 14447471939652046171ULL, 12499000959583175655ULL, 5340730406447097134ULL } } },
 { { { 1403754668487351297ULL, 8212934630767626223ULL, 14465782867917531230ULL, 6569381324520449529ULL },
 { 1600053119319486390ULL, 8224493116400833420ULL, 8371059096109669358ULL, 4998602122735993230ULL } },
 { { 9015524483141907146ULL, 10523519972085067825ULL, 16024345294832015166ULL, 959876197220078964ULL },
 { 13871504249060166799ULL, 18191922467422164484ULL, 12060227127483199650ULL, 1514501427322189470ULL } } },
 { { { 16421040216016728948ULL, 12608092003565210341ULL, 5505692019091248240ULL, 1884279007495786817ULL },
 { 2937864467332540984ULL, 3178016090114487303ULL, 3240228363632707076ULL, 9373700244625402379ULL } },
 { { 13358749642333051477ULL, 1387563973343141463ULL, 9022194158315539443ULL, 8324494681433748188ULL },
 { 16155686822102054990ULL, 1370774361876679779ULL, 12850453941193437827ULL, 164084462569977159ULL } } } },
{{ { { 15104225234899624339ULL, 14792602417856244379ULL, 11377846336710540090ULL, 4030649673103561902ULL },
 { 5845440128726717221ULL, 16712531373977292620ULL, 2755599689480280245ULL, 9551406596233813334ULL } },
 { { 14424234906381269531ULL, 16180567090055720812ULL, 17088698982981300325ULL, 3847024447637155562ULL },
 { 10605356667098651028ULL, 10909949144821338996ULL, 1698929895841543139ULL, 1249018556940556477ULL } } },
 { { { 2182223213502395653ULL, 9660986688887458887ULL, 16880408351334891221ULL, 2570884189470051150ULL },
 { 17120445837704480074ULL, 15952719275278255994ULL, 2871835638595243588ULL, 9619916044775367515ULL } },
 { { 10050281018665503092ULL, 6267596784865867854ULL, 16438241433157818765ULL, 4057496066452192213ULL },
 { 14817741518399555689ULL, 592658166028316114ULL, 17232231776328958382ULL, 4735802017502261087ULL } } },
 { { { 17972800413704898687ULL, 15030614930670052442ULL, 6765913407670935634ULL, 11487751271585671590ULL },
 { 15157229075703160228ULL, 3022384124142428896ULL, 16986964397499570618ULL, 10764501357143113952ULL } },
 { { 13261092486531284193ULL, 9072331640023449027ULL, 5775736412505369937ULL, 9674719028479743130ULL },
 { 13308323325273929941ULL, 10941358503644609290ULL, 558196982794241203ULL, 10841761446006065630ULL } } } },
{{ { { 11055848434102918668ULL, 12295814096043619367ULL, 3131641982697646943ULL, 11008893497850271493ULL },
 { 13798291837323850849ULL, 7311399647823752012ULL, 428754281927371228ULL, 499909352388434221ULL } },
 { { 12740149152087089825ULL, 17391348200769450508ULL, 18151984485346423623ULL, 3168792099826186933ULL },
 { 7125259887356460580ULL, 272908087696069030ULL, 10582844034414838459ULL, 281118846380551390ULL } } },
 { { { 1016960715141531920ULL, 7872153956928623937ULL, 498710751098015322ULL, 1745833386947725876ULL },
 { 10945489950860940184ULL, 12476767401536466959ULL, 4026066415511674073ULL, 5184091782760011425ULL } },
 { { 4860271298809871684ULL, 10426724686540570172ULL, 12834842855298835697ULL, 3040220904983778194ULL },
 { 17235315606203319919ULL, 18085409032492638504ULL, 13207029818237896105ULL, 9732975671582464926ULL } } },
 { { { 17064793647626258303ULL, 162705624296471510ULL, 12255179249911408044ULL, 5196150355852280188ULL },
 { 4179922201191718736ULL, 15791914312044483229ULL, 859232650502509092ULL, 2547925858652930647ULL } },
 { { 10412778974147528482ULL, 328534571151582973ULL, 9598381864860374263ULL, 2270675067728029131ULL },
 { 1692098667640050443ULL, 5156626139263591395ULL, 12566221832520440355ULL, 13072660527175566868ULL } } } },
{{ { { 8013993372521743825ULL, 185607427397839776ULL, 2005322578067850283ULL, 6207222886006490809ULL },
 { 14656375428906590441ULL, 11855199710494092698ULL, 9257201124060148630ULL, 2841703180968385179ULL } },
 { { 9013322800314877203ULL, 17246972008299564231ULL, 11270811725642949775ULL, 10805886397802541888ULL },
 { 11835732372786986757ULL, 18100277547942273114ULL, 12476024401461186368ULL, 9107474333571646622ULL } } },
 { { { 13284311676069251423ULL, 598769047917755373ULL, 2079887221193473954ULL, 6289035230512456505ULL },
 { 15565357676714332065ULL, 12255371562464757126ULL, 11888581708403530480ULL, 3656050346803991104ULL } },
 { { 14134256790212760259ULL, 14359409496171128722ULL, 15936579905987115289ULL, 7730819322251978222ULL },
 { 5139260513175028442ULL, 8585223457301663829ULL, 4256701715008459718ULL, 6548817600126671293ULL } } },
 { { { 18170582038133909574ULL, 1166134834458289313ULL, 127159249673078024ULL, 1040078505324758631ULL },
 { 16935820590829204286ULL, 7215385436226960552ULL, 14333237997739375358ULL, 4154544751283935184ULL } },
 { { 16901962993297608364ULL, 10722090500679031133ULL, 5824079337007688840ULL, 587384130474317314ULL },
 { 5220836303829711892ULL, 8642575630898729875ULL, 6328468390329988665ULL, 4752415097322181856ULL } } } },
{{ { { 5485212141678580658ULL, 2762741178652586250ULL, 3224256955526069496ULL, 8989347471879871063ULL },
 { 8891707050155718080ULL, 1279425495116917054ULL, 376783081203565560ULL, 11586736463328617163ULL } },
 { { 17913746938282856916ULL, 14853793189210583016ULL, 14147581947105148743ULL, 3250770809007185681ULL },
 { 5647313944925056173ULL, 696633189374912455ULL, 4863638195720448214ULL, 7406079045005176950ULL } } },
 { { { 7658051473989340526ULL, 3102657154035275607ULL, 2286082410635918258ULL, 10612129654222212883ULL },
 { 6526987402412688788ULL, 1345387682950343965ULL, 4125797482283874672ULL, 1282133038745231386ULL } },
 { { 110919933124525155ULL, 2147736059278226046ULL, 4144581407033984689ULL, 4688030328582340191ULL },
 { 5621490981669807435ULL, 12067604507773152669ULL, 8706444618752988998ULL, 7223960536024252382ULL } } },
 { { { 8217098512511931548ULL, 16795662415004562828ULL, 1014525092247027294ULL, 8896102794433563209ULL },
 { 8823535660410577573ULL, 14903224113597699711ULL, 16486617274927034112ULL, 1143256144793739971ULL } },
 { { 4329716266ULL, 15724318098964086784ULL, 4421900248ULL, 4421900080ULL },
 { 4294967283ULL, 3ULL, 4421900064ULL, 6983ULL } } } },
{{ { { 12322890889180892093ULL, 6707427166068218322ULL, 9376127996640117025ULL, 744914207894018766ULL },
 { 7020266649975035165ULL, 16158892490904355419ULL, 9033173474209348420ULL, 9814484967991759224ULL } },
 { { 7332174194328480443ULL, 11907677477571035511ULL, 8947856042385838574ULL, 1627504746163748467ULL },
 { 9773772695617301517ULL, 10568544114298475168ULL, 10362770485262376276ULL, 6071678447404651241ULL } } },
 { { { 15662571819113358896ULL, 8627116593453926048ULL, 10975656713469063184ULL, 4513613293740791502ULL },
 { 6407661763611242648ULL, 13926137164063106975ULL, 15622421070665917254ULL, 1464755789835660069ULL } },
 { { 9588897496994930512ULL, 17482770392149158092ULL, 16376725529936422398ULL, 8702918868461265911ULL },
 { 5795105874010345840ULL, 12505720406439300128ULL, 16144414453935914619ULL, 2875907987687494327ULL } } },
 { { { 11984616008066216189ULL, 12883910244282361646ULL, 14517271382441462782ULL, 466665322430651842ULL },
 { 11112634815397160089ULL, 16397579198851907392ULL, 15542667051056120367ULL, 2927885435839654315ULL } },
 { { 11143722001909612621ULL, 140732886307312ULL, 4421901864ULL, 11ULL },
 { 4421901888ULL, 4421901240ULL, 140732886313520ULL, 4329427918ULL } } } } };

proj torsion_basis[12][3];
proj torsion_basis_sum[3];
point torsion_basis_ted_sum[3];
proj torsion_basis_twist[19][3];
proj torsion_basis_twist_sum[3];
point torsion_basis_twist_ted_sum[3];
proj torsion_basis_two[3];



/*
static GEN alg_O0_to_standard(GEN elt) {
    return RgM_RgC_mul(global_setup.O0_to_standard, elt);
}

static GEN alg_standard_to_O0(GEN elt) {
    return RgM_RgC_mul(global_setup.standard_to_O0, elt);
}
*/

void init_precomputations() {
    global_setup.E0.x = fp2_0;
    global_setup.E0.z = fp2_1;

	global_setup.action_2 = malloc(12*sizeof(GEN));
	global_setup.action_3 = malloc(12*sizeof(GEN));
	global_setup.action_4 = malloc(12*sizeof(GEN));
	global_setup.action_twist_2 = malloc(19*sizeof(GEN));
	global_setup.action_twist_3 = malloc(19*sizeof(GEN));
	global_setup.action_twist_4 = malloc(19*sizeof(GEN));

	global_setup.action_2[0] = mkmat2(mkcol2(stoi(303076354265239ULL),stoi(127219176663798ULL)),mkcol2(stoi(269068339360086ULL),stoi(173760803937886ULL)));
	global_setup.action_3[0] = mkmat2(mkcol2(stoi(18811279965710ULL),stoi(306936153288974ULL)),mkcol2(stoi(218891294019890ULL),stoi(458025878237416ULL)));
	global_setup.action_4[0] = mkmat2(mkcol2(stoi(292868192162535ULL),stoi(263439778940754ULL)),mkcol2(stoi(302187664797350ULL),stoi(183968966040590ULL)));
	global_setup.action_2[1] = mkmat2(mkcol2(stoi(12ULL),stoi(25ULL)),mkcol2(stoi(4ULL),stoi(37ULL)));
	global_setup.action_3[1] = mkmat2(mkcol2(stoi(0ULL),stoi(0ULL)),mkcol2(stoi(24ULL),stoi(1ULL)));
	global_setup.action_4[1] = mkmat2(mkcol2(stoi(12ULL),stoi(25ULL)),mkcol2(stoi(6ULL),stoi(37ULL)));
	global_setup.action_2[2] = mkmat2(mkcol2(stoi(8ULL),stoi(4ULL)),mkcol2(stoi(3ULL),stoi(3ULL)));
	global_setup.action_3[2] = mkmat2(mkcol2(stoi(10ULL),stoi(2ULL)),mkcol2(stoi(10ULL),stoi(2ULL)));
	global_setup.action_4[2] = mkmat2(mkcol2(stoi(10ULL),stoi(2ULL)),mkcol2(stoi(5ULL),stoi(1ULL)));
	global_setup.action_2[3] = mkmat2(mkcol2(stoi(28ULL),stoi(2ULL)),mkcol2(stoi(26ULL),stoi(3ULL)));
	global_setup.action_3[3] = mkmat2(mkcol2(stoi(12ULL),stoi(7ULL)),mkcol2(stoi(21ULL),stoi(20ULL)));
	global_setup.action_4[3] = mkmat2(mkcol2(stoi(6ULL),stoi(19ULL)),mkcol2(stoi(3ULL),stoi(25ULL)));
	global_setup.action_2[4] = mkmat2(mkcol2(stoi(75ULL),stoi(11ULL)),mkcol2(stoi(62ULL),stoi(8ULL)));
	global_setup.action_3[4] = mkmat2(mkcol2(stoi(44ULL),stoi(33ULL)),mkcol2(stoi(81ULL),stoi(40ULL)));
	global_setup.action_4[4] = mkmat2(mkcol2(stoi(41ULL),stoi(10ULL)),mkcol2(stoi(56ULL),stoi(42ULL)));
	global_setup.action_2[5] = mkmat2(mkcol2(stoi(79ULL),stoi(19ULL)),mkcol2(stoi(15ULL),stoi(28ULL)));
	global_setup.action_3[5] = mkmat2(mkcol2(stoi(20ULL),stoi(5ULL)),mkcol2(stoi(31ULL),stoi(88ULL)));
	global_setup.action_4[5] = mkmat2(mkcol2(stoi(29ULL),stoi(34ULL)),mkcol2(stoi(98ULL),stoi(78ULL)));
	global_setup.action_2[6] = mkmat2(mkcol2(stoi(97ULL),stoi(46ULL)),mkcol2(stoi(129ULL),stoi(40ULL)));
	global_setup.action_3[6] = mkmat2(mkcol2(stoi(77ULL),stoi(94ULL)),mkcol2(stoi(66ULL),stoi(61ULL)));
	global_setup.action_4[6] = mkmat2(mkcol2(stoi(93ULL),stoi(5ULL)),mkcol2(stoi(106ULL),stoi(44ULL)));
	global_setup.action_2[7] = mkmat2(mkcol2(stoi(143ULL),stoi(410ULL)),mkcol2(stoi(463ULL),stoi(608ULL)));
	global_setup.action_3[7] = mkmat2(mkcol2(stoi(106ULL),stoi(5ULL)),mkcol2(stoi(27ULL),stoi(646ULL)));
	global_setup.action_4[7] = mkmat2(mkcol2(stoi(694ULL),stoi(472ULL)),mkcol2(stoi(157ULL),stoi(57ULL)));
	global_setup.action_2[8] = mkmat2(mkcol2(stoi(729ULL),stoi(696ULL)),mkcol2(stoi(793ULL),stoi(98ULL)));
	global_setup.action_3[8] = mkmat2(mkcol2(stoi(1ULL),stoi(289ULL)),mkcol2(stoi(0ULL),stoi(0ULL)));
	global_setup.action_4[8] = mkmat2(mkcol2(stoi(729ULL),stoi(623ULL)),mkcol2(stoi(793ULL),stoi(98ULL)));
	global_setup.action_2[9] = mkmat2(mkcol2(stoi(2614ULL),stoi(1988ULL)),mkcol2(stoi(861ULL),stoi(1077ULL)));
	global_setup.action_3[9] = mkmat2(mkcol2(stoi(2019ULL),stoi(3235ULL)),mkcol2(stoi(1213ULL),stoi(1673ULL)));
	global_setup.action_4[9] = mkmat2(mkcol2(stoi(757ULL),stoi(542ULL)),mkcol2(stoi(3376ULL),stoi(2934ULL)));
	global_setup.action_2[10] = mkmat2(mkcol2(stoi(3448ULL),stoi(573ULL)),mkcol2(stoi(2952ULL),stoi(571ULL)));
	global_setup.action_3[10] = mkmat2(mkcol2(stoi(1060ULL),stoi(1862ULL)),mkcol2(stoi(1616ULL),stoi(2960ULL)));
	global_setup.action_4[10] = mkmat2(mkcol2(stoi(3207ULL),stoi(1895ULL)),mkcol2(stoi(704ULL),stoi(812ULL)));
	global_setup.action_2[11] = mkmat2(mkcol2(stoi(558ULL),stoi(3525ULL)),mkcol2(stoi(6756ULL),stoi(6425ULL)));
	global_setup.action_3[11] = mkmat2(mkcol2(stoi(4533ULL),stoi(6338ULL)),mkcol2(stoi(2327ULL),stoi(2451ULL)));
	global_setup.action_4[11] = mkmat2(mkcol2(stoi(6201ULL),stoi(5010ULL)),mkcol2(stoi(4865ULL),stoi(782ULL)));
	global_setup.action_twist_2[0] = mkmat2(mkcol2(strtoi("12287179693426945945124233"),strtoi("10771711789126205244154436")),mkcol2(strtoi("6252639139252381899740717"),strtoi("7096065974253073951672490")));
	global_setup.action_twist_3[0] = mkmat2(mkcol2(strtoi("18055875521558539769585225"),strtoi("8434634270725359714389986")),mkcol2(strtoi("8539119081927317661367466"),strtoi("1327370146121480127211499")));
	global_setup.action_twist_4[0] = mkmat2(mkcol2(strtoi("16421210015209572728428437"),strtoi("7183435286404033745715527")),mkcol2(strtoi("19200714688796994327521339"),strtoi("2962035652470447168368286")));
	global_setup.action_twist_2[1] = mkmat2(mkcol2(stoi(3ULL),stoi(31ULL)),mkcol2(stoi(8ULL),stoi(40ULL)));
	global_setup.action_twist_3[1] = mkmat2(mkcol2(stoi(37ULL),stoi(27ULL)),mkcol2(stoi(4ULL),stoi(7ULL)));
	global_setup.action_twist_4[1] = mkmat2(mkcol2(stoi(20ULL),stoi(40ULL)),mkcol2(stoi(26ULL),stoi(23ULL)));
	global_setup.action_twist_2[2] = mkmat2(mkcol2(stoi(6066ULL),stoi(10107ULL)),mkcol2(stoi(1805ULL),stoi(4543ULL)));
	global_setup.action_twist_3[2] = mkmat2(mkcol2(stoi(1767ULL),stoi(8332ULL)),mkcol2(stoi(7686ULL),stoi(8843ULL)));
	global_setup.action_twist_4[2] = mkmat2(mkcol2(stoi(6836ULL),stoi(6621ULL)),mkcol2(stoi(10014ULL),stoi(3773ULL)));
	global_setup.action_twist_2[3] = mkmat2(mkcol2(stoi(8ULL),stoi(97ULL)),mkcol2(stoi(69ULL),stoi(101ULL)));
	global_setup.action_twist_3[3] = mkmat2(mkcol2(stoi(40ULL),stoi(57ULL)),mkcol2(stoi(8ULL),stoi(70ULL)));
	global_setup.action_twist_4[3] = mkmat2(mkcol2(stoi(6ULL),stoi(52ULL)),mkcol2(stoi(80ULL),stoi(103ULL)));
	global_setup.action_twist_2[4] = mkmat2(mkcol2(stoi(68ULL),stoi(74ULL)),mkcol2(stoi(37ULL),stoi(131ULL)));
	global_setup.action_twist_3[4] = mkmat2(mkcol2(stoi(134ULL),stoi(163ULL)),mkcol2(stoi(133ULL),stoi(66ULL)));
	global_setup.action_twist_4[4] = mkmat2(mkcol2(stoi(49ULL),stoi(48ULL)),mkcol2(stoi(93ULL),stoi(150ULL)));
	global_setup.action_twist_2[5] = mkmat2(mkcol2(stoi(196ULL),stoi(92ULL)),mkcol2(stoi(182ULL),stoi(31ULL)));
	global_setup.action_twist_3[5] = mkmat2(mkcol2(stoi(185ULL),stoi(132ULL)),mkcol2(stoi(68ULL),stoi(43ULL)));
	global_setup.action_twist_4[5] = mkmat2(mkcol2(stoi(67ULL),stoi(91ULL)),mkcol2(stoi(139ULL),stoi(160ULL)));
	global_setup.action_twist_2[6] = mkmat2(mkcol2(stoi(249ULL),stoi(160ULL)),mkcol2(stoi(131ULL),stoi(170ULL)));
	global_setup.action_twist_3[6] = mkmat2(mkcol2(stoi(405ULL),stoi(291ULL)),mkcol2(stoi(383ULL),stoi(15ULL)));
	global_setup.action_twist_4[6] = mkmat2(mkcol2(stoi(391ULL),stoi(277ULL)),mkcol2(stoi(7ULL),stoi(28ULL)));
	global_setup.action_twist_2[7] = mkmat2(mkcol2(stoi(128ULL),stoi(119ULL)),mkcol2(stoi(114ULL),stoi(363ULL)));
	global_setup.action_twist_3[7] = mkmat2(mkcol2(stoi(130ULL),stoi(281ULL)),mkcol2(stoi(67ULL),stoi(362ULL)));
	global_setup.action_twist_4[7] = mkmat2(mkcol2(stoi(63ULL),stoi(486ULL)),mkcol2(stoi(352ULL),stoi(428ULL)));
	global_setup.action_twist_2[8] = mkmat2(mkcol2(stoi(86ULL),stoi(0ULL)),mkcol2(stoi(279ULL),stoi(483ULL)));
	global_setup.action_twist_3[8] = mkmat2(mkcol2(stoi(8ULL),stoi(338ULL)),mkcol2(stoi(435ULL),stoi(562ULL)));
	global_setup.action_twist_4[8] = mkmat2(mkcol2(stoi(119ULL),stoi(49ULL)),mkcol2(stoi(100ULL),stoi(450ULL)));
	global_setup.action_twist_2[9] = mkmat2(mkcol2(stoi(261ULL),stoi(464ULL)),mkcol2(stoi(253ULL),stoi(370ULL)));
	global_setup.action_twist_3[9] = mkmat2(mkcol2(stoi(415ULL),stoi(29ULL)),mkcol2(stoi(70ULL),stoi(217ULL)));
	global_setup.action_twist_4[9] = mkmat2(mkcol2(stoi(82ULL),stoi(356ULL)),mkcol2(stoi(278ULL),stoi(549ULL)));
	global_setup.action_twist_2[10] = mkmat2(mkcol2(stoi(536ULL),stoi(580ULL)),mkcol2(stoi(533ULL),stoi(141ULL)));
	global_setup.action_twist_3[10] = mkmat2(mkcol2(stoi(290ULL),stoi(469ULL)),mkcol2(stoi(193ULL),stoi(388ULL)));
	global_setup.action_twist_4[10] = mkmat2(mkcol2(stoi(642ULL),stoi(493ULL)),mkcol2(stoi(347ULL),stoi(35ULL)));
	global_setup.action_twist_2[11] = mkmat2(mkcol2(stoi(680ULL),stoi(488ULL)),mkcol2(stoi(136ULL),stoi(177ULL)));
	global_setup.action_twist_3[11] = mkmat2(mkcol2(stoi(539ULL),stoi(384ULL)),mkcol2(stoi(36ULL),stoi(319ULL)));
	global_setup.action_twist_4[11] = mkmat2(mkcol2(stoi(152ULL),stoi(290ULL)),mkcol2(stoi(832ULL),stoi(705ULL)));
	global_setup.action_twist_2[12] = mkmat2(mkcol2(stoi(68ULL),stoi(668ULL)),mkcol2(stoi(393ULL),stoi(791ULL)));
	global_setup.action_twist_3[12] = mkmat2(mkcol2(stoi(777ULL),stoi(219ULL)),mkcol2(stoi(167ULL),stoi(83ULL)));
	global_setup.action_twist_4[12] = mkmat2(mkcol2(stoi(323ULL),stoi(757ULL)),mkcol2(stoi(227ULL),stoi(536ULL)));
	global_setup.action_twist_2[13] = mkmat2(mkcol2(stoi(589ULL),stoi(110ULL)),mkcol2(stoi(330ULL),stoi(294ULL)));
	global_setup.action_twist_3[13] = mkmat2(mkcol2(stoi(754ULL),stoi(746ULL)),mkcol2(stoi(377ULL),stoi(130ULL)));
	global_setup.action_twist_4[13] = mkmat2(mkcol2(stoi(809ULL),stoi(715ULL)),mkcol2(stoi(277ULL),stoi(74ULL)));
	global_setup.action_twist_2[14] = mkmat2(mkcol2(stoi(98ULL),stoi(806ULL)),mkcol2(stoi(313ULL),stoi(921ULL)));
	global_setup.action_twist_3[14] = mkmat2(mkcol2(stoi(84ULL),stoi(602ULL)),mkcol2(stoi(861ULL),stoi(936ULL)));
	global_setup.action_twist_4[14] = mkmat2(mkcol2(stoi(107ULL),stoi(250ULL)),mkcol2(stoi(1016ULL),stoi(912ULL)));
	global_setup.action_twist_2[15] = mkmat2(mkcol2(stoi(283ULL),stoi(94ULL)),mkcol2(stoi(20ULL),stoi(888ULL)));
	global_setup.action_twist_3[15] = mkmat2(mkcol2(stoi(1163ULL),stoi(988ULL)),mkcol2(stoi(1149ULL),stoi(9ULL)));
	global_setup.action_twist_4[15] = mkmat2(mkcol2(stoi(352ULL),stoi(581ULL)),mkcol2(stoi(211ULL),stoi(819ULL)));
	global_setup.action_twist_2[16] = mkmat2(mkcol2(stoi(373ULL),stoi(1438ULL)),mkcol2(stoi(716ULL),stoi(1506ULL)));
	global_setup.action_twist_3[16] = mkmat2(mkcol2(stoi(235ULL),stoi(64ULL)),mkcol2(stoi(1651ULL),stoi(1645ULL)));
	global_setup.action_twist_4[16] = mkmat2(mkcol2(stoi(303ULL),stoi(1173ULL)),mkcol2(stoi(1518ULL),stoi(1576ULL)));
	global_setup.action_twist_2[17] = mkmat2(mkcol2(stoi(97ULL),stoi(1094ULL)),mkcol2(stoi(1767ULL),stoi(2616ULL)));
	global_setup.action_twist_3[17] = mkmat2(mkcol2(stoi(766ULL),stoi(1528ULL)),mkcol2(stoi(2547ULL),stoi(1948ULL)));
	global_setup.action_twist_4[17] = mkmat2(mkcol2(stoi(1218ULL),stoi(408ULL)),mkcol2(stoi(2272ULL),stoi(1495ULL)));
	global_setup.action_twist_2[18] = mkmat2(mkcol2(stoi(1317ULL),stoi(2183ULL)),mkcol2(stoi(4028ULL),stoi(2966ULL)));
	global_setup.action_twist_3[18] = mkmat2(mkcol2(stoi(2375ULL),stoi(167ULL)),mkcol2(stoi(2028ULL),stoi(1909ULL)));
	global_setup.action_twist_4[18] = mkmat2(mkcol2(stoi(4070ULL),stoi(1494ULL)),mkcol2(stoi(4277ULL),stoi(213ULL)));


	global_setup.action_two_2 = mkmat2(mkcol2(stoi(8445835761ULL),stoi(3556983042ULL)),mkcol2(stoi(3141598735ULL),stoi(144098831ULL)));
	/* candidate 0010 */
	// global_setup.action_two_3 = mkmat2(mkcol2(stoi(8423158946ULL),stoi(7635840999ULL)),mkcol2(stoi(95806770ULL),stoi(166775647ULL)));
	// global_setup.action_two_4 = mkmat2(mkcol2(stoi(5329787622ULL),stoi(9718316341ULL)),mkcol2(stoi(3755338604ULL),stoi(3260146970ULL)));
	/* candidate 1011 */
	global_setup.action_two_3 = mkmat2(mkcol2(stoi(4128191650ULL),stoi(7635840999ULL)),mkcol2(stoi(4390774066ULL),stoi(4461742943ULL)));
	global_setup.action_two_4 = mkmat2(mkcol2(stoi(9624754918ULL),stoi(9718316341ULL)),mkcol2(stoi(3755338604ULL),stoi(7555114266ULL)));



  for (int i = 0; i < 3; ++i) {
    fp_enc( &(&(&torsion_basis_two[i])->x)->re, &(torsion_basis_two_uintbig[i][0][0]) );
    fp_enc( &(&(&torsion_basis_two[i])->z)->re, &(torsion_basis_two_uintbig[i][1][0]) );
    fp_enc( &(&(&torsion_basis_two[i])->z)->im, &(torsion_basis_two_uintbig[i][1][1]) );
    fp_enc( &(&(&torsion_basis_two[i])->x)->im, &(torsion_basis_two_uintbig[i][0][1]) );
  }
  for (int i=0;i<3;i++){
    fp_enc( &(&(&torsion_basis_sum[i])->x)->re, &(torsion_basis_sum_uintbig[i][0][0]) );
    fp_enc( &(&(&torsion_basis_sum[i])->x)->im, &(torsion_basis_sum_uintbig[i][0][1]) );
    fp_enc( &(&(&torsion_basis_sum[i])->z)->re, &(torsion_basis_sum_uintbig[i][1][0]) );
    fp_enc( &(&(&torsion_basis_sum[i])->z)->im, &(torsion_basis_sum_uintbig[i][1][1]) );
  }
  for (int i=0;i<3;i++){
    fp_enc( &(&(&torsion_basis_ted_sum[i])->x)->re, &(torsion_basis_ted_sum_uintbig[i][0][0]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->x)->im, &(torsion_basis_ted_sum_uintbig[i][0][1]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->y)->re, &(torsion_basis_ted_sum_uintbig[i][1][0]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->y)->im, &(torsion_basis_ted_sum_uintbig[i][1][1]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->z)->re, &(torsion_basis_ted_sum_uintbig[i][2][0]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->z)->im, &(torsion_basis_ted_sum_uintbig[i][2][1]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->t)->re, &(torsion_basis_ted_sum_uintbig[i][3][0]) );
    fp_enc( &(&(&torsion_basis_ted_sum[i])->t)->im, &(torsion_basis_ted_sum_uintbig[i][3][1]) );
  }
  for (int i=0;i<3;i++){
    fp_enc( &(&(&torsion_basis_twist_sum[i])->x)->re, &(torsion_basis_twist_sum_uintbig[i][0][0]) );
    fp_enc( &(&(&torsion_basis_twist_sum[i])->x)->im, &(torsion_basis_twist_sum_uintbig[i][0][1]) );
    fp_enc( &(&(&torsion_basis_twist_sum[i])->z)->re, &(torsion_basis_twist_sum_uintbig[i][1][0]) );
    fp_enc( &(&(&torsion_basis_twist_sum[i])->z)->im, &(torsion_basis_twist_sum_uintbig[i][1][1]) );
  }
  for (int i=0;i<3;i++){
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->x)->re, &(torsion_basis_twist_ted_sum_uintbig[i][0][0]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->x)->im, &(torsion_basis_twist_ted_sum_uintbig[i][0][1]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->y)->re, &(torsion_basis_twist_ted_sum_uintbig[i][1][0]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->y)->im, &(torsion_basis_twist_ted_sum_uintbig[i][1][1]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->z)->re, &(torsion_basis_twist_ted_sum_uintbig[i][2][0]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->z)->im, &(torsion_basis_twist_ted_sum_uintbig[i][2][1]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->t)->re, &(torsion_basis_twist_ted_sum_uintbig[i][3][0]) );
    fp_enc( &(&(&torsion_basis_twist_ted_sum[i])->t)->im, &(torsion_basis_twist_ted_sum_uintbig[i][3][1]) );
  }
  for (int j=0;j<12;j++){
    for (int i=0;i<3;i++){
      fp_enc( &(&(&torsion_basis[j][i])->x)->re, &(torsion_basis_uintbig[j][i][0][0]) );
      fp_enc( &(&(&torsion_basis[j][i])->x)->im, &(torsion_basis_uintbig[j][i][0][1]) );
      fp_enc( &(&(&torsion_basis[j][i])->z)->re, &(torsion_basis_uintbig[j][i][1][0]) );
      fp_enc( &(&(&torsion_basis[j][i])->z)->im, &(torsion_basis_uintbig[j][i][1][1]) );
    }

  }
  for (int j=0;j<19;j++){
    for (int i=0;i<3;i++){
      fp_enc( &(&(&torsion_basis_twist[j][i])->x)->re, &(torsion_basis_twist_uintbig[j][i][0][0]) );
      fp_enc( &(&(&torsion_basis_twist[j][i])->x)->im, &(torsion_basis_twist_uintbig[j][i][0][1]) );
      fp_enc( &(&(&torsion_basis_twist[j][i])->z)->re, &(torsion_basis_twist_uintbig[j][i][1][0]) );
      fp_enc( &(&(&torsion_basis_twist[j][i])->z)->im, &(torsion_basis_twist_uintbig[j][i][1][1]) );
    }

  }

	long var = fetch_var();
    GEN nf = nfinit(pol_x(fetch_var()),LOWDEFAULTPREC);
    GEN p = strtoi("73743043621499797449074820543863456997944695372324032511999999999999999999999");
    GEN B = alg_hilbert(nf, stoi(-1), negi(p), var, 0);

    GEN B_1 = mkcol4s(1,0,0,0);
    GEN B_i = mkcol4s(0,1,0,0);
    GEN B_j = mkcol4s(0,0,1,0);
    GEN B_ji = mkcol4s(0,0,0,1);


    GEN B_1k_2 = mkcol4(ghalf,gen_0,gen_0,gneg(ghalf)); // (1-ji)/2
    GEN B_ij_2 = mkcol4(gen_0,ghalf,ghalf,gen_0); // (i+j)/2

    global_setup.p = p;
    global_setup.B = B; // the quaternion algebra
    global_setup.qf = mkmat4(mkcol4s(1,0,0,0),
                             mkcol4s(0,1,0,0),
                             mkcol4(gen_0,gen_0,p,gen_0),
                             mkcol4(gen_0,gen_0,gen_0,p)); // quadratic form defined by the reduced norm

    //global_setup.torsion_fm = Z_factor_limit(strtoi(
    //    "197530174297949459837634878151545563369632855190375548677707409417459236752253845947265965991865263091519488000000000000000000000"
    //    ), 7000);


    global_setup.gen_p_plus_fact = cgetg(3, t_MAT);
    gel(global_setup.gen_p_plus_fact,1) = cgetg(p_plus_len+1, t_COL);
    gel(global_setup.gen_p_plus_fact,2) = cgetg(p_plus_len+1, t_COL);
    global_setup.gen_p_minus_fact = cgetg(3, t_MAT);
    gel(global_setup.gen_p_minus_fact,1) = cgetg(p_minus_len+1, t_COL);
    gel(global_setup.gen_p_minus_fact,2) = cgetg(p_minus_len+1, t_COL);

    global_setup.gen_p_plus_primary = cgetg(p_plus_len+1, t_VEC);
    global_setup.gen_p_minus_primary = cgetg(p_minus_len+1, t_VEC);

    for (int i = 0; i < p_plus_len; ++i) {
        gel(gel(global_setup.gen_p_plus_fact,1),i+1) = stoi(p_plus_fact[i]);
        gel(gel(global_setup.gen_p_plus_fact,2),i+1) = stoi(p_plus_mult[i]);
        gel(global_setup.gen_p_plus_primary,i+1) = powuu(p_plus_fact[i],p_plus_mult[i]);
    }

    for (int i = 0; i < p_minus_len; ++i) {
        gel(gel(global_setup.gen_p_minus_fact,1),i+1) = stoi(p_minus_fact[i]);
        gel(gel(global_setup.gen_p_minus_fact,2),i+1) = stoi(p_minus_mult[i]);
        gel(global_setup.gen_p_minus_primary,i+1) = powuu(p_minus_fact[i],p_minus_mult[i]);
    }

    global_setup.gen_odd_torsion = gmul(ZV_prod(global_setup.gen_p_plus_primary),
    	ZV_prod(global_setup.gen_p_minus_primary));


    global_setup.O0 = alglathnf(B,mkmat4(B_1, B_i, B_1k_2, B_ij_2), gen_0); // the cannonical maximal order


    global_setup.one = B_1;
    global_setup.i = B_i;
    global_setup.j = B_j;
    global_setup.ji = B_ji;

    global_setup.O0_b1 = B_1;
    global_setup.O0_b2 = B_i;
    global_setup.O0_b3 = B_1k_2;
    global_setup.O0_b4 = B_ij_2;
    global_setup.O0_to_standard = mkmat4(B_1, B_i, B_1k_2, B_ij_2);
    global_setup.standard_to_O0 = RgM_inv(global_setup.O0_to_standard);



    // output(alg_O0_to_standard(mkcol4s(1,0,0,0)));
    // output(alg_O0_to_standard(mkcol4s(0,1,0,0)));
    // output(alg_O0_to_standard(mkcol4s(0,0,1,0)));
    // output(alg_O0_to_standard(mkcol4s(0,0,0,1)));

}


long ell_to_index(long ell, bool *twist) {
	switch (ell) {
		case 3: *twist = true; return 0;
		case 43: *twist = true; return 1;
		case 103: *twist = true; return 2;
		case 109: *twist = true; return 3;
		case 199: *twist = true; return 4;
		case 227: *twist = true; return 5;
		case 419: *twist = true; return 6;
		case 491: *twist = true; return 7;
		case 569: *twist = true; return 8;
		case 631: *twist = true; return 9;
		case 677: *twist = true; return 10;
		case 857: *twist = true; return 11;
		case 859: *twist = true; return 12;
		case 883: *twist = true; return 13;
		case 1019: *twist = true; return 14;
		case 1171: *twist = true; return 15;
		case 1879: *twist = true; return 16;
		case 2713: *twist = true; return 17;
		case 4283: *twist = true; return 18;
		case 5: *twist = false; return 0;
		case 7: *twist = false; return 1;
		case 11: *twist = false; return 2;
		case 31: *twist = false; return 3;
		case 83: *twist = false; return 4;
		case 107: *twist = false; return 5;
		case 137: *twist = false; return 6;
		case 751: *twist = false; return 7;
		case 827: *twist = false; return 8;
		case 3691: *twist = false; return 9;
		case 4019: *twist = false; return 10;
		case 6983: *twist = false; return 11;
	}
	assert(0);
	return 0;
}

long ell_to_e(long ell) {
	switch (ell) {
		case 3: return 53;
		case 103: return 2;
		case 5: return 21;
		case 7: return 2;
		case 2: return 33;
		default: return 1;
	}
}
